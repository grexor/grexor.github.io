<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="keywords" content="gregor, rot, expressrna, microbeatlas, iclip, bioinformatics, gregor rot"/>
  <meta name="description" content="My research focuses on bioinformatics analysis of RNA, post-transcriptional modifications analysis, namely alternative splicing and alternative polyadenylation in connection with protein-RNA binding CLIP data. Lately i am exploring new possibilities with single-cell and long-read sequence data. My passion is also making scientific analysis available over nice web applications, such as expressRNA.org"/>
  <title>Mysql insert binary data from TAB files | Gregor Rot &#8211; Computer Science and Bioinformatics</title>
  <meta name="robots" content="noarchive">
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Gregor Rot" />
  <meta property="og:description" content="RNA Bioinformatics" />
  <meta property="og:url" content="https://grexor.github.io" />
  <meta property="og:site_name" content="Gregor Rot Bioinformatics" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="main.css">
  <link rel="icon" type="image/png" href="/img/rotlab_logo.png">

  <!-- font awesome -->
  <link href="fontawesome/css/all.css" rel="stylesheet">

</head>
<body>

<div class="container">
  <nav class="navbar navbar-expand-md">
    <a class="navbar-brand custom" href="/"><i class="far fa-smile-wink"></i></a>
    <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#main-navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="main-navigation">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" id="link_philosophy" href="philosophy.html"><i class="fas fa-mountain"></i>&nbsp;Philosophy</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="link_publications" href="publications.html"><i class="far fa-newspaper"></i>&nbsp;Publications</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="link_software" href="software.html"><i class="fas fa-file-code"></i>&nbsp;Software</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="link_blog" href="blog.html"><i class="fas fa-blog"></i>&nbsp;Blog</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="link_notebook" href="notebook.html"><i class="fas fa-book-reader"></i>&nbsp;Notebook</a>
        </li>
      </ul>
    </div>
  </nav>
</div>

<script>
  $("#link_blog").css("background-color", "#cacaca");
</script>

  <div class="container">
    <br>
    <p class="font-weight-light">
    <i class="fas fa-cubes"></i>&nbsp;&nbsp;<b>Mysql insert binary data from TAB files</b>
    <div style='padding-left: 5px; font-weight: 100'>
      <i class="far fa-dot-circle"></i>&nbsp;Motivation
      <div style='padding-left: 20px; font-weight: 100; padding-top: 4px; text-align: justify'>
        We are working with a lot of data for the <a href="https://microbeatlas.org" target=_new>microbeAtlas.org</a> project and we keep part of it (that needs to be text searchable) in a Mysql database. Alongside this data, we also would like to keep JSON objects that are large to some extend, and we compress them and store them in a binary form.
      </div>

<br>

      <i class="far fa-dot-circle"></i>&nbsp;Preparing data in TAB files
      <div style='padding-left: 20px; font-weight: 100; padding-top: 4px; text-align: justify'>
        Turns out the fastest way to populate a Mysql table is to load the data from a TAB file. Storing numbers and text in a text file is simple, however how do you store binary data and load it into Mysql? Turns out you need to use something like hexlify, so to represent the binary data in hex format, which can be stored as text. Let's look at how you would do that in Python:
<br><br>
<pre>
import zlib
import binascii

# compression and storage
my_data = "Some data I would like to compress and store as binary in hex format."
my_data_compressed = zlib.compress(my_data.encode())
my_data_compressed_hex = binascii.hexlify(my_data_compressed)

# write the data to the file
f = open("data.tab", "wt")
f.write("column1\tcolumn2\t%s" % my_data_compressed_hex)
</pre>
        Ekola, you would have now the data in a TAB delimited file (one line per row).
</div>

<br>

<i class="far fa-dot-circle"></i>&nbsp;Loading (storing) data into Mysql tables
<div style='padding-left: 20px; font-weight: 100; padding-top: 4px; text-align: justify'>
        How to store and load into Mysql? You would create a sql file in this direction:
        <br><br>
<pre>
DROP TABLE IF EXISTS my_table;
CREATE TABLE `my_table` (
	  `column_1` varchar(255) NOT NULL,
	  `column_2` text,
	  `column_3` LONGBLOB
    ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

LOAD DATA LOCAL INFILE "data.tab" INTO TABLE my_table FIELDS TERMINATED BY '\t' \
(column_1, column_2, @column_3_val) SET column_3 = UNHEX(@column_3_val);
</pre>

  Notice the UNHEX for the column_3 field, since we need to store in binary and not in hex strings. Voila.
      </div>

      <br><b><font color=green>Thanks for reading! and if it was helpful for you, leave a comment below.</font></b>

    </div>

    <br>

    <i class="far fa-dot-circle"></i>&nbsp;References: <a href='https://stackoverflow.com/questions/12038814/import-hex-binary-data-into-mysql' target=_new>Stackoverflow: Import hex/binary data into mysql</a>

    <br><br>

    <div id="disqus_thread"></div>
    <script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    var disqus_config = function () {
    this.page.title = "JS";
    this.page.url = "https://grexor.github.io/mysql_binary.html";
    this.page.identifier = "blog_febe";
    };
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://grexor.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  </div>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-38680782-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-38680782-6');
  </script>

  <div class='footer' style='padding-top: 10px; margin-top: 10px; padding-bottom: 20px; border-top: 1px dashed lightgray'>
    <center>

      <a href="https://twitter.com/gregor_rot"><i class="fab fa-twitter"></i>&nbsp;Follow me on Twitter</a>
      &nbsp;&nbsp;
      <i class="fas fa-hiking"></i>
      &nbsp;&nbsp;
      <a href="https://www.linkedin.com/in/gregorrot"><i class="fab fa-linkedin"></i>&nbsp;Connect on LinkedIn</a>
    </center>
  </div>

  </body>
  </html>
